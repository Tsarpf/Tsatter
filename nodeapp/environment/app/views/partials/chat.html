<span ng-controller="ChatController as chatCtrl" class="chat vspace col-xs-12">
    <div class="row tscontainer">
        <div class="users col-xs-1">
            <ts-user-bar></ts-user-bar>
        </div>

        <div class="messages col-xs-7"
             ng-show="!searching"
             adapter="messageAdapter"
             scroll-glue="glued"
             ui-scroll-viewport>

            <div ui-scroll="message in messageDatasource" buffer-size="25" class="backlog">
                <ts-chat-message></ts-chat-message>
            </div>

            <ts-chat-message ng-repeat="message in messages"></ts-chat-message>

            <!--
            <div ui-scroll="message in messageDatasource">
                {{message.message}}
            </div>
            -->

        </div>
        <div class="messages col-xs-7"
             ng-show="searching">
            <p> Click an image to link it to your message </p>
            <img class="loading-gif" src="https://i1.wp.com/cdnjs.cloudflare.com/ajax/libs/galleriffic/2.0.1/css/loader.gif" ng-show="waitingForSearchResults">
            <div deckgrid class="deckgrid row" source="searchResults">
                <div class="chat-summary tile clickable-element" ng-click="mother.searchResultClicked(card.$index)">
                    <img ng-src="{{card.thumbnail}}" class="chat-summary-picture">
                </div>
            </div>

         </div>

        <div class="tsmedia col-xs-4" scroll-glue="mediaGlued">
            <ts-media-bar></ts-media-bar>
        </div>

        <input
               ng-show="!editingNick"
               type="button"
               value="{{nick}}"
               class="col-xs-1 own-nick-area btn default"
               ng-click="editNick()">

        <input
               ng-show="editingNick"
               focus-on="editNick"
               ng-blur="stopEditingNick()"
               type="text"
               class="col-xs-1 own-nick-area"
               ng-model="nick"
               ng-click="ownNickAreaClicked()"
               ng-keyup="$event.keyCode == 13 && ownNickAreaSubmit()">

        <input
                ng-show="!searching"
                ng-keyup="$event.keyCode == 13 && chatCtrl.privmsg()"
                ng-change="messageChanged()"
                ng-model="message"
                placeholder="Type '@' to search and link pictures"
                type="text"
                class="new-message col-xs-7"
                focus-on="chatInput">

        <div class="input-group col-xs-7" ng-show="searching">
            <span class="input-group-addon">
                <span class="fui-search">
                </span>
            </span>
            <input
                    type="text"
                    class="new-message form-control"
                    placeholder="Esc to stop searching -- Enter to search"
                    ng-model="searchTerm"
                    ng-keydown="$event.keyCode == 27 && escPressedInSearch()"
                    ng-keyup="$event.keyCode == 13 && search()"
                    focus-on="searchInput">
        </div>
    </div>
 </span>
